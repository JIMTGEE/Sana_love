<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Une lettre d'amour sinc√®re</title>
    <link rel="icon" type="image/x-icon" href="https://i.loli.net/2021/06/03/lFg2V4WUcmkB98G.png">
    <meta name="language" content="fr">
    <meta name="title" content="Une lettre du c≈ìur">
    <meta name="description" content="Une lettre d'amour sinc√®re, exprimant des sentiments profonds">
    
    <!-- Responsive CSS -->
    <style>
        /* Reset and base styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        html {
            height: 100%;
            overflow-x: hidden;
        }
        
        body {
            font-family: 'Georgia', 'Times New Roman', serif;
            background: linear-gradient(135deg, #fef5f7 0%, #fff0f3 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            padding: 15px;
            position: relative;
            overflow-x: hidden;
        }
        
        /* Background overlay for better text readability */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: radial-gradient(circle at 50% 50%, rgba(255,255,255,0.9) 0%, rgba(255,240,243,0.7) 100%);
            z-index: -1;
        }
        
        /* Main container */
        #main {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            z-index: 1;
        }
        
        /* Error message styling */
        #error {
            display: none;
            background-color: rgba(255, 230, 230, 0.95);
            border: 1px solid #ff9999;
            padding: 15px 20px;
            margin-bottom: 20px;
            border-radius: 10px;
            text-align: center;
            width: 100%;
            backdrop-filter: blur(5px);
            box-shadow: 0 4px 15px rgba(255, 99, 99, 0.1);
        }
        
        #error a {
            color: #d32f2f;
            text-decoration: none;
            font-weight: bold;
            transition: color 0.3s;
        }
        
        #error a:hover {
            color: #b71c1c;
            text-decoration: underline;
        }
        
        /* Wrapper for content */
        #wrap {
            width: 100%;
            position: relative;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 25px;
        }
        
        /* Text content container */
        #text {
            width: 100%;
            max-width: min(800px, 95vw);
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: clamp(20px, 4vw, 40px);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.08);
            position: relative;
            z-index: 2;
            border: 1px solid rgba(255, 182, 193, 0.2);
            backdrop-filter: blur(10px);
        }
        
        /* Heart icon in text container */
        #text::before {
            content: '‚ù§Ô∏è';
            position: absolute;
            top: -15px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 24px;
            background: white;
            padding: 5px 10px;
            border-radius: 50%;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }
        
        /* Paragraph styling */
        .paragraph {
            margin-bottom: clamp(15px, 4vw, 25px);
            line-height: 1.8;
            font-size: clamp(1rem, 2.5vw, 1.15rem);
            text-align: justify;
            opacity: 0;
            transform: translateY(25px);
            transition: opacity 0.8s ease, transform 0.8s ease;
            padding: 0 5px;
        }
        
        .paragraph.visible {
            opacity: 1;
            transform: translateY(0);
        }
        
        /* Highlight important lines */
        .paragraph:nth-child(2),
        .paragraph:nth-child(6) {
            color: #b71c1c;
            font-weight: 500;
        }
        
        /* Signature styling */
        .signature {
            margin-top: clamp(25px, 6vw, 40px);
            text-align: right;
            font-style: italic;
            font-size: clamp(1.1rem, 3vw, 1.4rem);
            color: #b71c1c;
            font-weight: bold;
            opacity: 0;
            transition: opacity 1s ease;
            padding-right: 10px;
        }
        
        .signature.visible {
            opacity: 1;
        }
        
        .signature::before {
            content: "‚Äî ";
        }
        
        /* Poetic line styling */
        #poetic-line {
            text-align: center;
            margin: clamp(15px, 4vw, 25px) 0;
            color: #ff6b6b;
            font-style: italic;
            font-size: clamp(1rem, 3vw, 1.3rem);
            width: 100%;
            max-width: min(800px, 95vw);
            opacity: 0;
            transition: opacity 1s ease;
            padding: 15px;
            background: rgba(255, 255, 255, 0.9);
            border-radius: 15px;
            border-left: 4px solid #ff6b6b;
            border-right: 4px solid #ff6b6b;
        }
        
        #poetic-line.visible {
            opacity: 1;
        }
        
        /* Canvas container */
        #canvas-container {
            width: 100%;
            max-width: min(1100px, 95vw);
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 0 auto;
            border-radius: 15px;
            overflow: hidden;
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.12);
            background: linear-gradient(45deg, #ffebee 0%, #ffe6e9 100%);
            position: relative;
        }
        
        #canvas-container::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 15px;
            pointer-events: none;
            box-shadow: inset 0 0 20px rgba(0,0,0,0.05);
        }
        
        /* Canvas styling */
        #canvas {
            width: 100% !important;
            height: auto !important;
            aspect-ratio: 1100 / 680;
            display: block;
            max-height: 70vh;
        }
        
        /* Loading indicator */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 200px;
            font-size: clamp(1rem, 3vw, 1.3rem);
            color: #b71c1c;
            flex-direction: column;
            gap: 15px;
        }
        
        .loading::after {
            content: '';
            width: 40px;
            height: 40px;
            border: 3px solid #ff6b6b;
            border-top-color: transparent;
            border-radius: 50%;
            animation: loading 1s linear infinite;
        }
        
        @keyframes loading {
            to { transform: rotate(360deg); }
        }
        
        /* Hidden class */
        .hidden {
            display: none;
        }
        
        /* Hand cursor for interactive elements */
        .hand {
            cursor: pointer !important;
        }
        
        /* Mobile-specific adjustments */
        @media (max-width: 768px) {
            body {
                padding: 12px;
            }
            
            #wrap {
                gap: 20px;
            }
            
            #text {
                padding: 25px 20px;
                border-radius: 18px;
            }
            
            #text::before {
                font-size: 20px;
                top: -12px;
            }
            
            #poetic-line {
                padding: 12px;
                border-width: 3px;
            }
            
            .paragraph {
                font-size: 1.05rem;
                line-height: 1.7;
            }
        }
        
        @media (max-width: 480px) {
            body {
                padding: 10px;
                justify-content: flex-start;
                padding-top: 20px;
            }
            
            #text {
                padding: 20px 15px;
                border-radius: 15px;
            }
            
            #text::before {
                font-size: 18px;
                top: -10px;
            }
            
            .paragraph {
                font-size: 1rem;
                line-height: 1.6;
                margin-bottom: 20px;
            }
            
            .signature {
                margin-top: 30px;
                font-size: 1.2rem;
            }
            
            #poetic-line {
                font-size: 1.1rem;
                padding: 10px;
                margin: 15px 0;
            }
            
            #canvas-container {
                border-radius: 12px;
            }
            
            /* Touch-friendly tap targets */
            .hand::after {
                content: '';
                position: absolute;
                top: -10px;
                left: -10px;
                right: -10px;
                bottom: -10px;
            }
        }
        
        /* Very small screens */
        @media (max-width: 320px) {
            .paragraph {
                font-size: 0.95rem;
            }
            
            #text {
                padding: 15px 12px;
            }
        }
        
        /* Landscape orientation */
        @media (max-height: 600px) and (orientation: landscape) {
            body {
                padding: 10px;
                justify-content: flex-start;
            }
            
            #wrap {
                flex-direction: row;
                align-items: flex-start;
                flex-wrap: wrap;
                justify-content: center;
                gap: 15px;
            }
            
            #text {
                max-width: 45%;
                margin-bottom: 0;
            }
            
            #canvas-container {
                max-width: 50%;
                max-height: 70vh;
            }
            
            #poetic-line {
                width: 100%;
                max-width: 95%;
                margin-top: 15px;
            }
        }
        
        /* Dark mode support */
        @media (prefers-color-scheme: dark) {
            body {
                background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
                color: #e0e0e0;
            }
            
            body::before {
                background: radial-gradient(circle at 50% 50%, rgba(26,26,46,0.9) 0%, rgba(22,33,62,0.7) 100%);
            }
            
            #text {
                background-color: rgba(40, 44, 52, 0.95);
                border-color: rgba(255, 105, 180, 0.2);
                color: #e0e0e0;
            }
            
            #text::before {
                background: #282c34;
            }
            
            #poetic-line {
                background: rgba(40, 44, 52, 0.9);
                color: #ff6b6b;
            }
            
            .paragraph:nth-child(2),
            .paragraph:nth-child(6) {
                color: #ff9999;
            }
            
            .signature {
                color: #ff9999;
            }
            
            #canvas-container {
                background: linear-gradient(45deg, #2d3746 0%, #364152 100%);
            }
        }
        
        /* Animation keyframes */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes float {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-10px);
            }
        }
        
        /* Floating hearts in background */
        .floating-hearts {
            position: fixed;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 0;
        }
        
        .floating-hearts span {
            position: absolute;
            font-size: 20px;
            opacity: 0.1;
            animation: float 6s ease-in-out infinite;
        }
        
        /* Responsive typography */
        @media (min-width: 1400px) {
            .paragraph {
                font-size: 1.2rem;
            }
            
            .signature {
                font-size: 1.5rem;
            }
            
            #poetic-line {
                font-size: 1.4rem;
            }
        }
    </style>
</head>

<body>
    <!-- Floating hearts background -->
    <div class="floating-hearts" id="floating-hearts"></div>
    
    <div id="main">
        <div id="error">
            Cher(e) utilisateur(trice), votre navigateur ne supporte pas le contenu qui va s'afficher.<br>
            Veuillez utiliser <a href="https://www.google.com/chrome/">Chrome</a> ou <a href="https://www.mozilla.org/firefox/">Firefox</a>.
        </div>
        <div id="wrap">
            <div id="text" class="hidden">
                <div id="code">
                    <div class="paragraph">
                        Je t'aime, et ce n'est pas un sentiment l√©ger.
                    </div>
                    
                    <div class="paragraph">
                        Je t'aime m√™me quand √ßa fait mal, m√™me quand certaines choses me blessent.<br>
                        Pas parce que je suis faible, mais parce que mon amour est sinc√®re.
                    </div>
                    
                    <div class="paragraph">
                        Je crois en toi, en la personne que tu es aujourd'hui et en celle que tu peux devenir.<br>
                        Je veux √™tre l√† pour toi, soutenir tes r√™ves, ton avenir, ta vie.<br>
                        Je l'ai toujours voulu, et je le veux encore.
                    </div>
                    
                    <div class="paragraph">
                        Mais aimer, ce n'est pas seulement donner.<br>
                        J'aimerais aussi compter pour toi.<br>
                        √ätre une priorit√©, pas une option.<br>
                        √ätre choisi, respect√©, consid√©r√©.
                    </div>
                    
                    <div class="paragraph">
                        Je n'attends pas la perfection.<br>
                        J'esp√®re simplement un changement, un effort, une r√©ciprocit√©.<br>
                        Parce que l'amour, quand il est vrai, se construit √† deux.
                    </div>
                    
                    <div class="paragraph">
                        Je suis l√†, avec mon c≈ìur ouvert.<br>
                        Et malgr√© tout, je t'aime.
                    </div>
                    
                    <div class="signature">
                        Avec tout mon amour
                    </div>
                </div>
            </div>
            
            <div id="poetic-line" class="hidden">
                Un c≈ìur qui aime est un c≈ìur qui esp√®re...
            </div>
            
            <!-- Canvas container -->
            <div id="canvas-container">
                <canvas id="canvas"></canvas>
            </div>
        </div>
    </div>

    <!-- Audio player -->
    <audio preload="auto" autoplay loop id="media" style="display: none;">
        <source src="love.mp3" type="audio/mpeg">
        Votre navigateur ne supporte pas l'√©l√©ment audio.
    </audio>

    <!-- JavaScript Libraries - Fixed paths for GitHub Pages -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <!-- Fallback to local if CDN fails -->
    <script>
        window.jQuery || document.write('<script src="jquery.min.js"><\/script>');
    </script>

    <!-- Main Script -->
    <script>
        (function () {
            // Create floating hearts
            function createFloatingHearts() {
                const container = document.getElementById('floating-hearts');
                const hearts = ['‚ù§Ô∏è', 'üíñ', 'üíó', 'üíì', 'üíû', 'üíï'];
                
                for (let i = 0; i < 15; i++) {
                    const heart = document.createElement('span');
                    heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
                    heart.style.left = Math.random() * 100 + 'vw';
                    heart.style.top = Math.random() * 100 + 'vh';
                    heart.style.fontSize = (Math.random() * 20 + 15) + 'px';
                    heart.style.animationDelay = Math.random() * 5 + 's';
                    heart.style.animationDuration = (Math.random() * 3 + 4) + 's';
                    container.appendChild(heart);
                }
            }
            
            // Responsive initialization
            function initResponsive() {
                const canvas = document.getElementById('canvas');
                const container = document.getElementById('canvas-container');
                
                if (!canvas.getContext) {
                    document.getElementById("error").style.display = 'block';
                    return false;
                }

                // Get available space
                const maxWidth = Math.min(1100, window.innerWidth - 40);
                const maxHeight = Math.min(680, window.innerHeight * 0.7);
                
                // Calculate responsive dimensions
                const aspectRatio = 1100 / 680;
                let width = maxWidth;
                let height = width / aspectRatio;
                
                if (height > maxHeight) {
                    height = maxHeight;
                    width = height * aspectRatio;
                }
                
                // Set canvas dimensions
                canvas.width = width;
                canvas.height = height;
                canvas.style.width = width + 'px';
                canvas.style.height = height + 'px';
                
                // Update container size
                container.style.maxWidth = width + 'px';
                container.style.maxHeight = height + 'px';

                return {
                    width: width,
                    height: height,
                    canvas: canvas
                };
            }
            
            // Simple animation fallback for mobile
            function simpleAnimation() {
                const paragraphs = document.querySelectorAll('.paragraph');
                const signature = document.querySelector('.signature');
                const poeticLine = document.getElementById('poetic-line');
                const textContainer = document.getElementById('text');
                
                // Show text container
                textContainer.classList.remove('hidden');
                
                // Animate paragraphs
                paragraphs.forEach((para, index) => {
                    setTimeout(() => {
                        para.classList.add('visible');
                    }, index * 800);
                });
                
                // Show signature
                setTimeout(() => {
                    signature.classList.remove('hidden');
                    signature.classList.add('visible');
                }, paragraphs.length * 800);
                
                // Show poetic line
                setTimeout(() => {
                    poeticLine.classList.remove('hidden');
                    poeticLine.classList.add('visible');
                }, paragraphs.length * 800 + 500);
                
                // Start music if available
                const audio = document.getElementById('media');
                if (audio && typeof audio.play === 'function') {
                    audio.play().catch(e => console.log("Audio autoplay prevented:", e));
                }
            }
            
            // Main initialization
            function init() {
                // Create background hearts
                createFloatingHearts();
                
                // Initialize responsive layout
                const dimensions = initResponsive();
                
                // Try to load external scripts
                loadExternalScripts().then(() => {
                    // If scripts loaded successfully, run the original animation
                    if (window.Tree && window.Jscex) {
                        runTreeAnimation(dimensions);
                    } else {
                        // Fallback to simple animation
                        simpleAnimation();
                    }
                }).catch(() => {
                    // Fallback to simple animation
                    simpleAnimation();
                });
                
                // Handle window resize
                let resizeTimeout;
                window.addEventListener('resize', () => {
                    clearTimeout(resizeTimeout);
                    resizeTimeout = setTimeout(initResponsive, 250);
                });
            }
            
            // Load external scripts
            function loadExternalScripts() {
                return new Promise((resolve, reject) => {
                    // Try to load from local files first
                    const scripts = [
                        'love.js',
                        'functions.js'
                    ];
                    
                    let loaded = 0;
                    
                    scripts.forEach(src => {
                        const script = document.createElement('script');
                        script.src = src;
                        script.onload = () => {
                            loaded++;
                            if (loaded === scripts.length) resolve();
                        };
                        script.onerror = () => {
                            loaded++;
                            if (loaded === scripts.length) reject();
                        };
                        document.head.appendChild(script);
                    });
                    
                    // If no scripts are found, reject immediately
                    if (scripts.length === 0) reject();
                });
            }
            
            // Run the tree animation (simplified version)
            function runTreeAnimation(dimensions) {
                try {
                    // Your existing tree animation code would go here
                    // For now, we'll use the simple animation
                    simpleAnimation();
                } catch (error) {
                    console.error("Animation error:", error);
                    simpleAnimation();
                }
            }
            
            // Start everything when DOM is loaded
            document.addEventListener('DOMContentLoaded', init);
            
            // Ensure audio can play on mobile
            document.addEventListener('touchstart', function() {
                const audio = document.getElementById('media');
                if (audio && audio.paused) {
                    audio.play().catch(e => console.log("Audio play failed:", e));
                }
            }, { once: true });
            
        })();
    </script>

</body>
</html>
